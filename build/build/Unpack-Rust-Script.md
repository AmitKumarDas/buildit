### Shoutout
```yaml
- https://rust-script.org/
```

### Rust TILs
```yaml
- Debug Formatter: {:?}
- #!/usr/bin/env rust-script as a shebang line
- -e/--expr option to accept a Rust expression
- -d/--dep option to accepts dependencies (if any)
```

### What makes Rust Expression to Work
```yaml
- The code given is EMBEDDED into a block expression
- EVALUATED
- PRINTED out using the Debug formatter (i.e. {:?})
```

### Writing a Quick Filter via Closures
```sh
# Each LINE is passed via STDIN                   üéñÔ∏èüéñÔ∏èüéñÔ∏è
cat now.ers | rust-script --loop \
    "let mut n=0; move |l| {n+=1; println!(\"{:>6}: {}\",n,l.trim_end())}"
```
```sh
 1: // cargo-deps: time="0.1.25"
 3: fn main() {
 4:     println!("{}", time::now().rfc822z());
 5: }
```

### More Closure: Count
```sh
# LINE NUMBER is passed as SECOND ARG             üéñÔ∏èüéñÔ∏èüéñÔ∏è
# LINE is passed as FIRST ARG
# All are passed via STDIN
cat now.ers | rust-script --count --loop \
    "|l,n| println!(\"{:>6}: {}\", n, l.trim_end())"
```
```sh
 1: // cargo-deps: time="0.1.25"
 2: fn main() {
 3:     println!("{}", time::now().rfc822z());
 4: }
```

### Testing Practice
```yaml
- BUSINESS LOGIC & TESTING the same should be done in SAME LANGUAGE
- Test the EXECUTION / EXPECTATION of running the code files in plain SCRIPTS
```

```sh
#!/bin/sh
set -e -u
assert_equals() {
    if [ "$1" != "$2" ]; then
      echo "Invalid output: Expected '$1', was '$2'"
      exit 1
    fi
}
assert_equals "result: 3" "$(just -f justfile/Justfile)"
assert_equals "hello, rust" "$(./hello.ers)"
assert_equals "hello, rust" "$(./hello-without-main.ers)"

HYPERFINE_OUTPUT=$(rust-script --wrapper "hyperfine --runs 99" fib.ers)

case "$HYPERFINE_OUTPUT" in
  *"99 runs"*)
    ;;
  *)
    echo "Hyperfine output: $HYPERFINE_OUTPUT"
    exit 1
    ;;
esac
```

### ENV Variable Practice
```yaml
- RUST_SCRIPT_BASE_PATH               # üéñÔ∏èüéñÔ∏èüéñÔ∏è - Context / Prefix
- RUST_SCRIPT_PKG_NAME
- RUST_SCRIPT_SAFE_NAME
- RUST_SCRIPT_PATH
```

### DEBUGGING Practice
```yaml
- Run with the RUST_LOG=rust_script=trace environment variable set  # üéñÔ∏èüéñÔ∏èüéñÔ∏è - Usage = =
- To see verbose log output
- Attach that output to the JIRA or GITHUB issue
```

### Code Generation Practice
```yaml
- CODE_GEN: Script SAVED & CACHED
- CODE_GEN: Script may be distributed as PACKAGED artifact
- CODE_GEN: REPRODUCIBILITY: Cargo.lock is generated
- DEPENDENCIES: PINNED: YES
- TESTABILITY: YES
- ADVANCED_NEEDS:
  - MULTI_PLATFORM: Container Images?
  - PRECONDITION: INSTALL_DEPENDENCIES: Container Images?
  - DEVEX: Container Images?
  - PERFORMANCE: Via Cache & Container Images?
  - BENCHMARKING: Yes via Hyperfine
```

```toml
[[bin]]
name = "expr_925350e4bb9a73e58f87395a"
path = "expr.rs"

[dependencies]

[package]
authors = ["Anonymous"]
edition = "2018"
name = "expr"
version = "0.1.0"
[profile.release]
strip = true
```

```sh
$ cat Cargo.lock

# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 3

[[package]]
name = "expr"
version = "0.1.0"
```

